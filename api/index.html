<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>API参考 | vuex-sugar</title>
    <meta name="description" content="一个帮助简化使用 Vuex 发起 HTTP(REST API)请求的工具。支持 Vuex 2，默认使用流行的 HTTP 客户端axios发起请求。">
    
    
    <link rel="preload" href="/vuex-sugar/assets/css/0.styles.9d4c9b2f.css" as="style"><link rel="preload" href="/vuex-sugar/assets/js/app.91decff7.js" as="script"><link rel="preload" href="/vuex-sugar/assets/js/5.77932b6a.js" as="script"><link rel="prefetch" href="/vuex-sugar/assets/js/3.ca7ab6eb.js"><link rel="prefetch" href="/vuex-sugar/assets/js/4.2f0723e8.js"><link rel="prefetch" href="/vuex-sugar/assets/js/6.2aa257e1.js"><link rel="prefetch" href="/vuex-sugar/assets/js/7.36608444.js"><link rel="prefetch" href="/vuex-sugar/assets/js/8.b4007df4.js"><link rel="prefetch" href="/vuex-sugar/assets/js/9.42285dd6.js"><link rel="prefetch" href="/vuex-sugar/assets/js/vendors~docsearch.a9e1ffb7.js">
    <link rel="stylesheet" href="/vuex-sugar/assets/css/0.styles.9d4c9b2f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuex-sugar/" class="home-link router-link-active"><!----> <span class="site-name">vuex-sugar</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuex-sugar/" class="nav-link">首页</a></div><div class="nav-item"><a href="/vuex-sugar/guide/" class="nav-link">指南</a></div><div class="nav-item"><a href="/vuex-sugar/api/" class="nav-link router-link-exact-active router-link-active">API</a></div><div class="nav-item"><a href="https://github.com/Liaoct/vuex-sugar/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuex-sugar/api/" class="nav-link router-link-exact-active router-link-active">简体中文</a></li><li class="dropdown-item"><!----> <a href="/vuex-sugar/en/" class="nav-link">English</a></li></ul></div></div> <a href="https://github.com/Liaoct/vuex-sugar" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vuex-sugar/" class="nav-link">首页</a></div><div class="nav-item"><a href="/vuex-sugar/guide/" class="nav-link">指南</a></div><div class="nav-item"><a href="/vuex-sugar/api/" class="nav-link router-link-exact-active router-link-active">API</a></div><div class="nav-item"><a href="https://github.com/Liaoct/vuex-sugar/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuex-sugar/api/" class="nav-link router-link-exact-active router-link-active">简体中文</a></li><li class="dropdown-item"><!----> <a href="/vuex-sugar/en/" class="nav-link">English</a></li></ul></div></div> <a href="https://github.com/Liaoct/vuex-sugar" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/vuex-sugar/api/" class="active sidebar-link">API参考</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#构造函数" class="sidebar-link">构造函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#vuexsugar" class="sidebar-link">VuexSugar</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#vuexsugar-实例选项" class="sidebar-link">VuexSugar 实例选项</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#axios" class="sidebar-link">axios</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#baseurl" class="sidebar-link">baseUrl</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#namespaced" class="sidebar-link">namespaced</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#validateresponse" class="sidebar-link">validateResponse</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#meta" class="sidebar-link">meta</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#resolved" class="sidebar-link">resolved</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#rejected" class="sidebar-link">rejected</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#state" class="sidebar-link">state</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#vuexsugar-实例方法" class="sidebar-link">VuexSugar 实例方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#add" class="sidebar-link">add</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#get" class="sidebar-link">get</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#delete" class="sidebar-link">delete</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#head" class="sidebar-link">head</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#options" class="sidebar-link">options</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#post" class="sidebar-link">post</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#put" class="sidebar-link">put</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#patch" class="sidebar-link">patch</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#getstore" class="sidebar-link">getStore</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#action-选项" class="sidebar-link">action 选项</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#action" class="sidebar-link">action</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#property" class="sidebar-link">property</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#path" class="sidebar-link">path</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#headers" class="sidebar-link">headers</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#method" class="sidebar-link">method</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#requestconfig" class="sidebar-link">requestConfig</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#meta-2" class="sidebar-link">meta</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#resolved-2" class="sidebar-link">resolved</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#rejected-2" class="sidebar-link">rejected</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#successhandler" class="sidebar-link">successHandler</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#errorhandler" class="sidebar-link">errorHandler</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#before" class="sidebar-link">before</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#after" class="sidebar-link">after</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#store-选项" class="sidebar-link">store 选项</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#createstatefn" class="sidebar-link">createStateFn</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#coursestate" class="sidebar-link">courseState</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#successsuffix" class="sidebar-link">successSuffix</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#errorsuffix" class="sidebar-link">errorSuffix</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#action-提交参数" class="sidebar-link">action 提交参数</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#全局属性" class="sidebar-link">全局属性</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#全局方法" class="sidebar-link">全局方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#creatstore" class="sidebar-link">creatStore</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#mergestore" class="sidebar-link">mergeStore</a></li><li class="sidebar-sub-header"><a href="/vuex-sugar/api/#setglobal" class="sidebar-link">setGlobal</a></li></ul></li></ul></li></ul> </div> <div class="page"> <div class="content"><h1 id="api参考"><a href="#api参考" aria-hidden="true" class="header-anchor">#</a> API参考</h1> <h2 id="构造函数"><a href="#构造函数" aria-hidden="true" class="header-anchor">#</a> 构造函数</h2> <h3 id="vuexsugar"><a href="#vuexsugar" aria-hidden="true" class="header-anchor">#</a> VuexSugar</h3> <ul><li><p><strong>函数签名</strong>: <code>constructor(options:Object):VuexSugar</code></p></li> <li><p><strong>用法</strong>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> VuexSugar <span class="token operator">=</span> <span class="token function">VuexSugar</span><span class="token punctuation">(</span><span class="token punctuation">{</span> baseURL<span class="token punctuation">:</span> <span class="token string">''</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 等效</span>
<span class="token keyword">const</span> VuexSugar <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VuexSugar</span><span class="token punctuation">(</span><span class="token punctuation">{</span> baseURL<span class="token punctuation">:</span> <span class="token string">''</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>VuexSugar</code>方法内部会隐式的使用<code>new</code>创建一个对象。可以传入一个<a href="#vuexsugar-%E5%AE%9E%E4%BE%8B%E9%80%89%E9%A1%B9">实例选项对象</a>。</p></li></ul> <h2 id="vuexsugar-实例选项"><a href="#vuexsugar-实例选项" aria-hidden="true" class="header-anchor">#</a> VuexSugar 实例选项</h2> <p>实例选项对象在初始化<code>VuexSugar</code>实例时传入。</p> <h3 id="axios"><a href="#axios" aria-hidden="true" class="header-anchor">#</a> axios</h3> <ul><li><p><strong>类型</strong>: <code>axios</code> (instance)</p></li> <li><p><strong>默认值</strong>: <code>axios</code> (instance)</p></li> <li><p><strong>用法</strong>:</p> <div class="language- extra-class"><pre class="language-text"><code>import Axios from 'axios'
import VuexSugar from 'vuex-sugar';

const service = Axios.create({
    withCredentials: true,
    headers: { 'X-Requested-With': 'XMLHttpRequest' }
});

VuexSugar({
    axios: service
})
</code></pre></div><p><code>axios</code>可以是任何有效的<code>axios</code>实例。可以自定义<code>axios</code>实例，或者其他能够返回 Promise 的 Http 请求工具。默认使用<code>axios</code>。</p></li></ul> <h3 id="baseurl"><a href="#baseurl" aria-hidden="true" class="header-anchor">#</a> baseUrl</h3> <ul><li><p><strong>类型</strong>: <code>string</code></p></li> <li><p><strong>用法</strong>:</p> <div class="language- extra-class"><pre class="language-text"><code>VuexSugar({
    baseURL: '/v1/client'
})
</code></pre></div><p><code>baseURL</code>将传入<code>axios</code>实例。除了实例选项可以设置<code>baseURL</code>，<a href="#action-%E9%80%89%E9%A1%B9">action 选项</a>的<code>requestConfig</code>参数也可以指定请求的<code>baseURL</code>。</p> <p>如果这两个地方都没有设置，将使用<code>axios</code>默认的<code>baseURL</code>。优先权：<code>request config base URL &gt; baseURL &gt; axios instance base URL</code></p></li></ul> <h3 id="namespaced"><a href="#namespaced" aria-hidden="true" class="header-anchor">#</a> namespaced</h3> <ul><li><p><strong>类型</strong>: <code>boolean</code></p></li> <li><p><strong>默认值</strong>: <code>false</code></p></li> <li><p><strong>用法</strong>:</p> <div class="language- extra-class"><pre class="language-text"><code>VuexSugar({
    namespaced: true
})
</code></pre></div><p>指定该实例下的<code>store</code>是否具有命名空间，与 Vuex <code>namespaced</code>意义相同。</p></li></ul> <h3 id="validateresponse"><a href="#validateresponse" aria-hidden="true" class="header-anchor">#</a> validateResponse</h3> <ul><li><p><strong>类型</strong>: <code>function</code></p></li> <li><p><strong>函数签名</strong>: <code>validateResponse(res: Response): boolean</code></p></li> <li><p><strong>默认值</strong>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">validateResponse</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>res<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> status<span class="token punctuation">,</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> res<span class="token punctuation">;</span>
    <span class="token keyword">const</span> isServerOk <span class="token operator">=</span> <span class="token operator">!</span>data <span class="token operator">||</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>code <span class="token operator">?</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>code<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">200</span> <span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> status <span class="token operator">===</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> isServerOk<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p><strong>详细</strong>: <code>vuex-sugar</code>假定服务端 REST API 返回的结果形式如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
    code<span class="token punctuation">:</span> number<span class="token punctuation">,</span>
    data<span class="token punctuation">:</span> any<span class="token punctuation">,</span>
    msg<span class="token punctuation">:</span> string
<span class="token punctuation">}</span>
</code></pre></div><p>其中<code>code</code>与 HTTP <code>status</code>意义相同，<code>data</code>为实际返回的结果，<code>msg</code>为额外的信息。REST 采用此设计，主要在于服务端能够返回更多信息给前端，方便前端灵活处理。如果你的项目中，采用其他的结构，可以重写<code>validateResponse</code>以便决定请求成功或者失败。</p></li> <li><p><strong>用法</strong>:</p> <div class="language- extra-class"><pre class="language-text"><code>function validateResponse(res) {
    if (!res) return false;
    const { status } = res;
    return status &gt;= 200 &amp;&amp; status &lt; 300 ;
}

VuexSugar({
    validateResponse
})
</code></pre></div><p><code>vuex-sugar</code>将使用新的方法来判断请求结果。</p></li></ul> <h3 id="meta"><a href="#meta" aria-hidden="true" class="header-anchor">#</a> meta</h3> <ul><li><p><strong>类型</strong>: <code>object</code></p></li> <li><p><strong>用法</strong>:</p> <div class="language- extra-class"><pre class="language-text"><code>VuexSugar({
    meta: { username: 'test' }
})
</code></pre></div><p>添加实例元数据，函数类型的<code>headers</code>与<code>path</code>能够访问它，被该实例的所有<code>action</code>共享。将与<a href="#action-%E9%80%89%E9%A1%B9">action 选项</a>的<code>meta</code>、<a href="#action-%E6%8F%90%E4%BA%A4%E5%8F%82%E6%95%B0">action 提交参数</a>中的<code>meta</code>进行合并。</p></li></ul> <h3 id="resolved"><a href="#resolved" aria-hidden="true" class="header-anchor">#</a> resolved</h3> <ul><li><p><strong>类型</strong>: <code>String|Object|Function|Array</code></p></li> <li><p><strong>用法</strong>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> posts <span class="token operator">=</span> <span class="token function">VuexSugar</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    baseURL<span class="token punctuation">:</span> <span class="token string">'/v1/client'</span><span class="token punctuation">,</span>
    state<span class="token punctuation">:</span> <span class="token punctuation">{</span> posts<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 该实例每个action均会在请求成功时执行全局的message action。root参数表示该action为全局action。</span>
    resolved<span class="token punctuation">:</span> <span class="token punctuation">{</span> action<span class="token punctuation">:</span> <span class="token string">'message'</span><span class="token punctuation">,</span> root<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>设置实例的<code>resolved</code>，用于设置请求成功的回调，被该实例的所有<code>action</code>共享，最终会被合并到<code>action</code>中。</p> <ul><li><p><code>String</code> 类型：表示回调执行一个<code>action</code>。该<code>action</code>只能是本实例<code>store</code>的<code>action</code>。如果需要向全局提交<code>action</code>，或者为<code>action</code>传递参数，则使用对象形式。</p></li> <li><p><code>Object</code> 类型：用于回调执行<code>action</code>。格式同<a href="#action-%E6%8F%90%E4%BA%A4%E5%8F%82%E6%95%B0">action 提交参数</a>:</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
    <span class="token comment">// 只有action属性是必须的</span>
    action<span class="token punctuation">:</span> String<span class="token punctuation">,</span> <span class="token comment">// action name</span>
    <span class="token punctuation">[</span>root<span class="token punctuation">]</span><span class="token punctuation">:</span> boolean<span class="token punctuation">,</span> <span class="token comment">// global dispatch</span>
    <span class="token comment">// 可以添加其他任何action提交参数</span>
    <span class="token punctuation">[</span>data<span class="token punctuation">]</span><span class="token punctuation">:</span> Object<span class="token punctuation">,</span> <span class="token comment">// http data</span>
    <span class="token punctuation">[</span>params<span class="token punctuation">]</span><span class="token punctuation">:</span> Object<span class="token punctuation">,</span><span class="token comment">// http params</span>
    <span class="token punctuation">[</span><span class="token operator">...</span> other action dispatch options<span class="token punctuation">]</span>
    <span class="token comment">// 也可以添加除action提交参数以外的数据</span>
    <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span> other payload<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><code>Function</code> 类型：回调执行函数。函数参数为<code>(Response, rest)</code>。<code>response</code>为请求返回结果，<code>rest</code>为<code>action</code>提交时除提交参数以外的数据。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updatePost</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    data <span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    data1<span class="token punctuation">,</span> <span class="token comment">// data1不属于action提交参数，将会被原样传送给回调函数</span>
    data2<span class="token punctuation">,</span>
    <span class="token operator">...</span><span class="token punctuation">,</span>
    <span class="token function-variable function">resolved</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">res<span class="token punctuation">,</span> <span class="token punctuation">{</span> data1<span class="token punctuation">,</span> data2<span class="token punctuation">,</span> <span class="token operator">...</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// 剩余数据将会被传递给回调函数</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><code>Array</code> 类型：可包含以上任一类型，甚至嵌套的数组。</li></ul></li></ul> <h3 id="rejected"><a href="#rejected" aria-hidden="true" class="header-anchor">#</a> rejected</h3> <ul><li><p><strong>类型</strong>: <code>String|Object|Function|Array</code></p></li> <li><p><strong>用法</strong>:</p> <p>与<code>resolved</code>相同，用于设置请求失败的回调。</p></li></ul> <h3 id="state"><a href="#state" aria-hidden="true" class="header-anchor">#</a> state</h3> <ul><li><p><strong>类型</strong>: <code>Object|Function</code></p></li> <li><p><strong>默认值</strong>: <code>{}</code></p></li> <li><p><strong>用法</strong>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> posts <span class="token operator">=</span> <span class="token function">VuexSugar</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    baseURL<span class="token punctuation">:</span> <span class="token string">'/v1/client'</span><span class="token punctuation">,</span>
    state<span class="token punctuation">:</span> <span class="token punctuation">{</span> posts<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>设置 store 的默认<code>state</code>，<code>state</code>应该与<code>action</code>中的<code>property</code>对应。如果没有指定默认的<code>state</code>，则默认为<code>null</code>。</p> <p>如果<code>state</code>为函数形式，则在实例初始化时被执行。函数应该返回一个纯对象。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> posts <span class="token operator">=</span> <span class="token function">VuexSugar</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    baseURL<span class="token punctuation">:</span> <span class="token string">'/v1/client'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">state</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span> posts<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token comment">// 返回纯对象</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>注意：该函数并不是最终生成的<code>state</code>，如果需要最终生成的<code>state</code>为函数，请在<a href="#store-%E9%80%89%E9%A1%B9">store选项</a>中指定。</p> <p>当请求成功时，将自动更新<code>property</code>对应的<code>state</code>。</p></li></ul> <h2 id="vuexsugar-实例方法"><a href="#vuexsugar-实例方法" aria-hidden="true" class="header-anchor">#</a> VuexSugar 实例方法</h2> <p>调用实例方法添加<code>action</code>，并生成<code>store</code>。</p> <h3 id="add"><a href="#add" aria-hidden="true" class="header-anchor">#</a> add</h3> <ul><li><p><strong>函数签名</strong>: <code>(options: Object): VuexSugar</code></p></li> <li><p><strong>用法</strong>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    action<span class="token punctuation">:</span> <span class="token string">'listPosts'</span><span class="token punctuation">,</span>
    property<span class="token punctuation">:</span> <span class="token string">'posts'</span><span class="token punctuation">,</span>
    path<span class="token punctuation">:</span> <span class="token string">'/posts'</span><span class="token punctuation">,</span>
    method<span class="token punctuation">:</span> <span class="token string">'get'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>在<code>VuexSugar</code>实例上添加一个<code>action</code>，返回该实例。添加<code>action</code>并不是真正的<code>Vuex action</code>，这里只是添加了<code>Vuex action</code>的定义。可以通过<a href="#action-options">选项对象</a>设置<code>action</code>。</p> <p>选项对象中<code>action</code>为必须字段。更多选项，请参考<a href="#action-options">action 选项</a>。</p></li></ul> <h3 id="get"><a href="#get" aria-hidden="true" class="header-anchor">#</a> get</h3> <ul><li><p><strong>函数签名</strong>: <code>(options: Object): VuexSugar</code></p></li> <li><p><strong>用法</strong>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    action<span class="token punctuation">:</span> <span class="token string">'listPosts'</span><span class="token punctuation">,</span>
    property<span class="token punctuation">:</span> <span class="token string">'posts'</span><span class="token punctuation">,</span>
    path<span class="token punctuation">:</span> <span class="token string">'/posts'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 等同于</span>
<span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    action<span class="token punctuation">:</span> <span class="token string">'listPosts'</span><span class="token punctuation">,</span>
    property<span class="token punctuation">:</span> <span class="token string">'posts'</span><span class="token punctuation">,</span>
    path<span class="token punctuation">:</span> <span class="token string">'/posts'</span><span class="token punctuation">,</span>
    method<span class="token punctuation">:</span> <span class="token string">'get'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>add</code>方法的别名，<code>get</code>请求的快捷方法。</p></li></ul> <h3 id="delete"><a href="#delete" aria-hidden="true" class="header-anchor">#</a> delete</h3> <ul><li><p><strong>函数签名</strong>: <code>(options: Object): VuexSugar</code></p></li> <li><p><strong>用法</strong>:</p> <p><code>add</code>方法的别名，<code>delete</code>请求的快捷方法。</p></li></ul> <h3 id="head"><a href="#head" aria-hidden="true" class="header-anchor">#</a> head</h3> <ul><li><p><strong>函数签名</strong>: <code>(options: Object): VuexSugar</code></p></li> <li><p><strong>用法</strong>:</p> <p><code>add</code>方法的别名，<code>head</code>请求的快捷方法。</p></li></ul> <h3 id="options"><a href="#options" aria-hidden="true" class="header-anchor">#</a> options</h3> <ul><li><p><strong>函数签名</strong>: <code>(options: Object): VuexSugar</code></p></li> <li><p><strong>用法</strong>:</p> <p><code>add</code>方法的别名，<code>options</code>请求的快捷方法。</p></li></ul> <h3 id="post"><a href="#post" aria-hidden="true" class="header-anchor">#</a> post</h3> <ul><li><p><strong>函数签名</strong>: <code>(options: Object): VuexSugar</code></p></li> <li><p><strong>用法</strong>:</p> <p><code>add</code>方法的别名，<code>post</code>请求的快捷方法。</p></li></ul> <h3 id="put"><a href="#put" aria-hidden="true" class="header-anchor">#</a> put</h3> <ul><li><p><strong>函数签名</strong>: <code>(options: Object): VuexSugar</code></p></li> <li><p><strong>用法</strong>:</p> <p><code>add</code>方法的别名，<code>put</code>请求的快捷方法。</p></li></ul> <h3 id="patch"><a href="#patch" aria-hidden="true" class="header-anchor">#</a> patch</h3> <ul><li><p><strong>函数签名</strong>: <code>(options: Object): VuexSugar</code></p></li> <li><p><strong>用法</strong>:</p> <p><code>add</code>方法的别名，<code>patch</code>请求的快捷方法。</p></li></ul> <h3 id="getstore"><a href="#getstore" aria-hidden="true" class="header-anchor">#</a> getStore</h3> <ul><li><p><strong>函数签名</strong>: <code>(options: Object): Store</code></p></li> <li><p><strong>用法</strong>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">VuexSugar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStore</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    courseState<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 自动生成pending与error数据</span>
    createStateFn<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token comment">// 返回的state为函数形式</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>可以传入<a href="#store-%E9%80%89%E9%A1%B9">store选项参数</a>，用于生成 Vuex store 对象。</p> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token punctuation">{</span>
     namespaced<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
     state<span class="token punctuation">:</span> <span class="token punctuation">{</span>
         pending<span class="token punctuation">:</span> <span class="token punctuation">{</span>
             posts<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
             post<span class="token punctuation">:</span> <span class="token boolean">false</span>
         <span class="token punctuation">}</span><span class="token punctuation">,</span>
         error<span class="token punctuation">:</span> <span class="token punctuation">{</span>
             posts<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
             post<span class="token punctuation">:</span> <span class="token keyword">null</span>
         <span class="token punctuation">}</span><span class="token punctuation">,</span>
         posts<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
         post<span class="token punctuation">:</span> <span class="token keyword">null</span>
     <span class="token punctuation">}</span><span class="token punctuation">,</span>
     mutations<span class="token punctuation">:</span> <span class="token punctuation">{</span>
         <span class="token constant">LIST_POSTS</span><span class="token punctuation">:</span> Function<span class="token punctuation">,</span>
         <span class="token constant">LIST_POSTS_SUCCEEDED</span><span class="token punctuation">:</span> Function<span class="token punctuation">,</span>
         <span class="token constant">LIST_POSTS_FAILED</span><span class="token punctuation">:</span> Function<span class="token punctuation">,</span>
         <span class="token constant">GET_POST</span><span class="token punctuation">:</span> Function<span class="token punctuation">,</span>
         <span class="token constant">GET_POST_SUCCEEDED</span><span class="token punctuation">:</span> Function<span class="token punctuation">,</span>
         <span class="token constant">GET_POST_FAILED</span><span class="token punctuation">:</span> Function<span class="token punctuation">,</span>
         <span class="token constant">UPDATE_POST</span><span class="token punctuation">:</span> Function<span class="token punctuation">,</span>
         <span class="token constant">UPDATE_POST_SUCCEEDED</span><span class="token punctuation">:</span> Function<span class="token punctuation">,</span>
         <span class="token constant">UPDATE_POST_FAILED</span><span class="token punctuation">:</span> Function
     <span class="token punctuation">}</span><span class="token punctuation">,</span>

     actions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
         listPosts<span class="token punctuation">:</span> Function<span class="token punctuation">,</span>
         getPost<span class="token punctuation">:</span> Function<span class="token punctuation">,</span>
         updatePost<span class="token punctuation">:</span> Function
     <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre></div></li></ul> <h2 id="action-选项"><a href="#action-选项" aria-hidden="true" class="header-anchor">#</a> action 选项</h2> <p>定义<code>action</code>属性。</p> <h3 id="action"><a href="#action" aria-hidden="true" class="header-anchor">#</a> action</h3> <ul><li><p><strong>类型</strong>: <code>String</code></p></li> <li><p><strong>用法</strong>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    action<span class="token punctuation">:</span> <span class="token string">'listPosts'</span><span class="token punctuation">,</span>
    property<span class="token punctuation">:</span> <span class="token string">'posts'</span><span class="token punctuation">,</span>
    path<span class="token punctuation">:</span> <span class="token string">'/posts'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>指定<code>action</code>的 name，可通过 Vuex store 的<code>dispatch</code>进行提交。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// direct via store</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'listPosts'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> params<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> data<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// or with mapActions</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">listPosts</span><span class="token punctuation">(</span><span class="token punctuation">{</span> params<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> data<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h3 id="property"><a href="#property" aria-hidden="true" class="header-anchor">#</a> property</h3> <ul><li><p><strong>类型</strong>: <code>String</code></p></li> <li><p><strong>用法</strong>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    action<span class="token punctuation">:</span> <span class="token string">'listPosts'</span><span class="token punctuation">,</span>
    property<span class="token punctuation">:</span> <span class="token string">'posts'</span><span class="token punctuation">,</span>
    path<span class="token punctuation">:</span> <span class="token string">'/posts'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>指定<code>action</code>对应的<code>state</code>字段。如果没有指定该字段，则不会自动更改<code>state</code>，即使指定了默认的<code>state</code>。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> posts <span class="token operator">=</span> <span class="token function">VuexSugar</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    baseURL<span class="token punctuation">:</span> <span class="token string">'/v1/client'</span><span class="token punctuation">,</span>
    state<span class="token punctuation">:</span> <span class="token punctuation">{</span> posts<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        action<span class="token punctuation">:</span> <span class="token string">'getPost'</span><span class="token punctuation">,</span> <span class="token comment">// action name</span>
        property<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span> <span class="token comment">// state property name</span>
        <span class="token function-variable function">path</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> id <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token string">`/posts/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        action<span class="token punctuation">:</span> <span class="token string">'listPosts'</span><span class="token punctuation">,</span>
        <span class="token comment">// property: 'posts', // 没有指定property</span>
        path<span class="token punctuation">:</span> <span class="token string">'/posts'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        action<span class="token punctuation">:</span> <span class="token string">'updatePost'</span><span class="token punctuation">,</span>
        property<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
        <span class="token function-variable function">path</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> id <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token string">`/posts/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">getStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// create store object</span>

<span class="token comment">// post默认值为null，会自动设置post。</span>
<span class="token comment">// posts虽然设置了默认值，但是没有对应的property，因此不会自动改变。</span>
</code></pre></div><p>当不需要<code>state</code>存储数据，例如某些全局提交，或者普通的<code>action</code>，则可省略<code>property</code>，这很有必要。</p></li></ul> <h3 id="path"><a href="#path" aria-hidden="true" class="header-anchor">#</a> path</h3> <ul><li><p><strong>类型</strong>: <code>String|Function</code></p></li> <li><p><strong>用法</strong>:</p> <p>Api 请求的路径，如果<code>path</code>为相对路径，则会自动使用<code>baseURL</code>作为前缀。</p> <p>如果<code>path</code>为函数，则可使用<code>meta</code>元数据，<code>path</code>在发起请求前会自动执行。<code>path</code>应该返回字符串路径。</p> <p>详细使用方法参考<a href="/vuex-sugar/guide/tutorial.html#在header和path中使用参数">在 headers 和 path 中使用参数</a>。</p></li></ul> <h3 id="headers"><a href="#headers" aria-hidden="true" class="header-anchor">#</a> headers</h3> <ul><li><p><strong>类型</strong>: <code>Object|Function</code></p></li> <li><p><strong>用法</strong>:</p> <p>Api 请求头部，该选项的值将与<a href="#requestconfig">requestConfig</a>属性中的<code>headers</code>合并。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    action<span class="token punctuation">:</span> <span class="token string">'getPost'</span><span class="token punctuation">,</span> <span class="token comment">// action name</span>
    property<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span> <span class="token comment">// state property name</span>
    headers<span class="token punctuation">:</span> <span class="token punctuation">{</span> userName<span class="token punctuation">:</span> <span class="token string">'test'</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如果<code>headers</code>为函数，则可使用<code>meta</code>元数据，<code>headers</code>在发起请求前会自动执行。<code>headers</code>应该返回对象数据。</p> <p>详细使用方法参考<a href="/vuex-sugar/guide/tutorial.html#在header和path中使用参数">在 headers 和 path 中使用参数</a></p></li></ul> <h3 id="method"><a href="#method" aria-hidden="true" class="header-anchor">#</a> method</h3> <ul><li><p><strong>类型</strong>: <code>String</code></p></li> <li><p><strong>用法</strong>:</p> <p>Http 请求的<code>method</code>字段。允许的值为：<code>['get', 'delete', 'head', 'options', 'post', 'put', 'patch']</code>。</p> <p>当使用<a href="/vuex-sugar/guide/tutorial.html#http-快捷方法">HTTP快捷方法</a>时，不需要指定该字段。</p></li></ul> <h3 id="requestconfig"><a href="#requestconfig" aria-hidden="true" class="header-anchor">#</a> requestConfig</h3> <ul><li><p><strong>类型</strong>: <code>Object</code></p></li> <li><p><strong>用法</strong>:</p> <p><code>Axios</code>的请求选项参数。该选项中指定的属性具有最高优先权（<code>params</code>、<code>data</code>除外）。</p></li></ul> <h3 id="meta-2"><a href="#meta-2" aria-hidden="true" class="header-anchor">#</a> meta</h3> <ul><li><p><strong>类型</strong>: <code>object</code></p></li> <li><p><strong>用法</strong>:</p> <p>添加<code>action</code>元数据，将与<a href="#action-%E9%80%89%E9%A1%B9">action 选项</a>的<code>meta</code>、<a href="#action-%E6%8F%90%E4%BA%A4%E5%8F%82%E6%95%B0">action 提交参数</a>中的<code>meta</code>进行合并。</p></li></ul> <h3 id="resolved-2"><a href="#resolved-2" aria-hidden="true" class="header-anchor">#</a> resolved</h3> <ul><li><p><strong>类型</strong>: <code>String|Object|Funtion|Array</code></p></li> <li><p><strong>用法</strong>:</p> <p>设置当前<code>action</code>的<code>resolved</code>，用于设置请求成功的回调。将与<a href="#action-%E9%80%89%E9%A1%B9">action 选项</a>的<code>resolved</code>、<a href="#action-%E6%8F%90%E4%BA%A4%E5%8F%82%E6%95%B0">action 提交参数</a>中的<code>resolved</code>进行合并。</p></li></ul> <h3 id="rejected-2"><a href="#rejected-2" aria-hidden="true" class="header-anchor">#</a> rejected</h3> <ul><li><p><strong>类型</strong>: <code>String|Object|Funtion|Array</code></p></li> <li><p><strong>用法</strong>:</p> <p>与<code>resolved</code>相同，用于设置请求失败的回调。</p></li></ul> <h3 id="successhandler"><a href="#successhandler" aria-hidden="true" class="header-anchor">#</a> successHandler</h3> <ul><li><p><strong>类型</strong>: <code>Function</code></p></li> <li><p><strong>参数</strong>: <code>(state, { data, other })</code></p></li> <li><p><strong>用法</strong>:</p> <p>用于设置请求成功时，覆盖默认的改变<code>state</code>的行为。见<a href="/vuex-sugar/guide/tutorial.html#自定义请求处理方法">自定义请求处理方法</a>。</p> <p>第二个参数包含了接口的返回结果。如果在<a href="#action-%E6%8F%90%E4%BA%A4%E5%8F%82%E6%95%B0">action提交参数</a>中，添加了其他额外数据，也会被合并传入进来。</p></li></ul> <h3 id="errorhandler"><a href="#errorhandler" aria-hidden="true" class="header-anchor">#</a> errorHandler</h3> <ul><li><p><strong>类型</strong>: <code>Function</code></p></li> <li><p><strong>参数</strong>: <code>(state, payload)</code></p></li> <li><p><strong>用法</strong>:</p> <p>第二个参数为错误信息。</p></li></ul> <h3 id="before"><a href="#before" aria-hidden="true" class="header-anchor">#</a> before</h3> <ul><li><p><strong>类型</strong>: <code>Function</code></p></li> <li><p><strong>参数</strong>: <code>(error, data: any, context: { dispatch, commit, state, rootState })</code> 第三个参数为<code>Vuex action</code>参数</p></li> <li><p><strong>用法</strong>:</p> <p>在 <code>action</code> 执行（发起请求）之前执行钩子函数。注意：普通 <code>action</code> 也会执行 <code>before</code> 钩子函数。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    action<span class="token punctuation">:</span> <span class="token string">'getPost'</span><span class="token punctuation">,</span> <span class="token comment">// action name</span>
    property<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span> <span class="token comment">// state property name</span>
    headers<span class="token punctuation">:</span> <span class="token punctuation">{</span> userName<span class="token punctuation">:</span> <span class="token string">'test'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">before</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> dispatch <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'action name'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre></div><p>在<code>action</code>执行之前还没有任何数据参数，因此第二个参数始终为空，与<code>node</code>接口保持一致。</p></li></ul> <h3 id="after"><a href="#after" aria-hidden="true" class="header-anchor">#</a> after</h3> <ul><li><p><strong>类型</strong>: <code>Function</code></p></li> <li><p><strong>参数</strong>: <code>(error, data: any, context: { dispatch, commit, state, rootState })</code> 第三个参数为<code>Vuex action</code>的第一个参数</p> <p>在 action 执行（发起请求）之后执行钩子函数。用法同<code>before</code>一致。</p> <p>第一个参数为错误对象，第二个参数为请求结果。普通 <code>action</code> 的前两个参数都为空。</p></li></ul> <h2 id="store-选项"><a href="#store-选项" aria-hidden="true" class="header-anchor">#</a> store 选项</h2> <p>控制生成的<code>store</code>的结构。</p> <h3 id="createstatefn"><a href="#createstatefn" aria-hidden="true" class="header-anchor">#</a> createStateFn</h3> <ul><li><p><strong>类型</strong>: <code>boolean</code></p></li> <li><p><strong>默认值</strong>: <code>false</code></p></li> <li><p><strong>用法</strong>:</p> <p>设置返回的<code>state</code>是否为函数形式。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">VuexSugar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStore</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    courseState<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 自动生成pending与error数据</span>
    createStateFn<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token comment">// 返回的state为函数形式</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>返回的 store 为:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
    namespaced<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token function-variable function">state</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            pending<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                posts<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                post<span class="token punctuation">:</span> <span class="token boolean">false</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            error<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                posts<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
                post<span class="token punctuation">:</span> <span class="token keyword">null</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            posts<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            post<span class="token punctuation">:</span> <span class="token keyword">null</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>默认返回的<code>state</code>不被函数包裹。</p></li></ul> <h3 id="coursestate"><a href="#coursestate" aria-hidden="true" class="header-anchor">#</a> courseState</h3> <ul><li><p><strong>类型</strong>: <code>boolean</code></p></li> <li><p><strong>默认值</strong>: <code>true</code></p></li> <li><p><strong>用法</strong>:</p> <p>设置是否默认生成<code>pending</code>与<code>error</code>等数据。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">VuexSugar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStore</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    courseState<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 不自动生成pending与error数据</span>
    createStateFn<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token comment">// 返回的state为函数形式</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>返回的 store 为:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
    namespaced<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token function-variable function">state</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            posts<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            post<span class="token punctuation">:</span> <span class="token keyword">null</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <h3 id="successsuffix"><a href="#successsuffix" aria-hidden="true" class="header-anchor">#</a> successSuffix</h3> <ul><li><p><strong>类型</strong>: <code>String</code></p></li> <li><p><strong>默认值</strong>: <code>SUCCEEDED</code></p></li> <li><p><strong>用法</strong>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">VuexSugar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStore</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    successSuffix<span class="token punctuation">:</span> <span class="token string">'REQUEST_OK'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>设置<code>mutations type</code>的后缀。请求成功时，将与<a href="#action">action name</a>一起作为<code>mutation</code>的 type。这在手动触发<code>mutation</code>时，很有用。</p></li></ul> <h3 id="errorsuffix"><a href="#errorsuffix" aria-hidden="true" class="header-anchor">#</a> errorSuffix</h3> <ul><li><p><strong>类型</strong>: <code>String</code></p></li> <li><p><strong>默认值</strong>: <code>FAILED</code></p></li> <li><p><strong>用法</strong>:</p> <p>设置<code>mutations type</code>的后缀。请求失败时，将与<a href="#action">action name</a>一起作为<code>mutation</code>的 type。同<code>successSuffix</code>。</p></li></ul> <h2 id="action-提交参数"><a href="#action-提交参数" aria-hidden="true" class="header-anchor">#</a> action 提交参数</h2> <p>dispatch action时可以附带一些提交参数。</p> <ul><li><p><strong>类型</strong>: <code>{ [params: Object], [data: Object], [meta: OBject], [after: Funtion], [before: Funciton], [resolved:String|Object|Function|Array], [rejected:String|Object|Function|Array], [...any] }</code></p></li> <li><p><strong>用法</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updatePost</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">resolved</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>btnEnable <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 执行成功按钮恢复可点击</span>
    <span class="token function-variable function">rejected</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>btnEnable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 执行过程中按钮不可点击</span>
    meta<span class="token punctuation">:</span> <span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token number">123</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>提交<code>action</code>时，可以指定请求参数，或者传入来自页面的元数据，或者页面组件的回调等内容。</p> <p>这里可以传入<code>after</code>、<code>before</code>钩子函数，分别在请求发起之前与请求发起之后调用。函数签名为<code>(error, data: any, context: { dispatch, commit, state, rootState })</code>。</p> <p>其中第一个参数为<code>error</code>对象，第二个在<code>after</code>中是请求的返回结果。注意：这里请求成功或者失败都会被调用，同<a href="#before">action选项before与after</a>。</p> <p>注意<code>after</code>区别于<code>resolved</code>与<code>rejected</code>，虽然他们都能完成绝大部分相同的工作。但是<code>after</code>不管成功或失败都会调用，<code>resolved</code>与<code>rejected</code>只有在确定成功或失败才会分别调用。</p> <p>添加<code>after</code>、<code>before</code>钩子函数的好处在于，可以在请求开始前后做一些额外的操作，比如：更改页面的状态。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
    params<span class="token punctuation">,</span> <span class="token comment">// 请求参数对象，将被传入axios</span>
    data<span class="token punctuation">,</span> <span class="token comment">// 提交的数据队形，将被传入axios</span>
    meta<span class="token punctuation">,</span> <span class="token comment">// 提交的元数据，会被action的header或者path函数使用</span>
    after<span class="token punctuation">,</span> <span class="token comment">// action的前置钩子函数</span>
    before<span class="token punctuation">,</span> <span class="token comment">// action的后置钩子函数，注意：普通action也会执行before与after</span>
    resolved<span class="token punctuation">,</span> <span class="token comment">// 请求成功的回调，详细使用方式将`Vuex实例选项`</span>
    rejected<span class="token punctuation">,</span> <span class="token comment">// 请求失败的回调，实际上：普通action也会执行resolved与rejected</span>
    <span class="token operator">...</span>other <span class="token comment">// 提交action时，传递的额外数据。这些数据会传入successHandler，或者传入resolved（rejected）中规定的下一个action</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <h2 id="全局属性"><a href="#全局属性" aria-hidden="true" class="header-anchor">#</a> 全局属性</h2> <p><code>Vuex-Sugar</code>拥有一些全局属性，他们会被每个<code>Vuex-Sugar</code>实例使用。</p> <p>全局属性对象<code>VuexSugar.defaults</code>：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
    baseURL<span class="token punctuation">,</span>
    axios<span class="token punctuation">,</span>
    namespaced<span class="token punctuation">,</span>
    validateResponse<span class="token punctuation">,</span>
    meta<span class="token punctuation">,</span> <span class="token comment">// 全局元数据，将与action定义、action提交参数进行合并。{ ...GlobalDefaults.meta, ...ActionOptions.meta, ...ActionPayload.meta }</span>
    resolved<span class="token punctuation">,</span> <span class="token comment">// 全局回调，将与action定义、action提交参数进行合并。[ ...GlobalDefaults.resolved, ...ActionOptions.resolved, ...ActionPayload.resolved ]</span>
    rejected<span class="token punctuation">;</span> <span class="token comment">// 全局回调，将与action定义、action提交参数进行合并。[ ...GlobalDefaults.rejected, ...ActionOptions.rejected, ...ActionPayload.rejected ]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>可以使用全局方法<code>setGlobal</code>设置<a href="/vuex-sugar/guide/tutorial.html#使用回调">全局属性</a>，默认全局属性为空。</p> <h2 id="全局方法"><a href="#全局方法" aria-hidden="true" class="header-anchor">#</a> 全局方法</h2> <p><code>Vuex-Sugar</code>导出了一些辅助方法，便于使用<code>Store</code>。</p> <h3 id="creatstore"><a href="#creatstore" aria-hidden="true" class="header-anchor">#</a> creatStore</h3> <ul><li><p><strong>函数签名</strong>: <code>(VuexSugar, options: Object): store</code></p></li> <li><p><strong>用法</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> VuexSugar<span class="token punctuation">,</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vuex-sugar'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">VuexSugar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">createStore</span><span class="token punctuation">(</span>store<span class="token punctuation">,</span> <span class="token punctuation">{</span> createStateFn<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>VuexSugar</code>实例的<a href="#getstore">getStore</a>调用了该方法，根据<code>VuexSugar</code>实例创建一个 <a href="/vuex-sugar/guide/quick-start.html#store对象的结构">Store对象</a>。</p></li></ul> <h3 id="mergestore"><a href="#mergestore" aria-hidden="true" class="header-anchor">#</a> mergeStore</h3> <ul><li><p><strong>函数签名</strong>: <code>(store, [store]): store</code></p></li> <li><p><strong>用法</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> VuexSugar<span class="token punctuation">,</span> <span class="token punctuation">{</span> mergeStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vuex-sugar'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">VuexSugar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">mergeStore</span><span class="token punctuation">(</span>store<span class="token punctuation">,</span> <span class="token punctuation">{</span> state<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> mutations<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> getters<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> actions<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>允许混入其他自定义的 store。</p></li></ul> <h3 id="setglobal"><a href="#setglobal" aria-hidden="true" class="header-anchor">#</a> setGlobal</h3> <ul><li><p><strong>函数签名</strong>: <code>(defaultOptions): VuexSugar</code></p></li> <li><p><strong>用法</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> VuexSugar<span class="token punctuation">,</span> <span class="token punctuation">{</span> mergeStore<span class="token punctuation">,</span> setGlobal <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vuex-sugar'</span><span class="token punctuation">;</span>

<span class="token comment">// 设置全局属性</span>
<span class="token function">setGlobal</span><span class="token punctuation">(</span><span class="token punctuation">{</span> baseURL<span class="token punctuation">,</span> axios <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// or 也可以这样设置</span>
VuexSugar<span class="token punctuation">.</span><span class="token function">setGlobal</span><span class="token punctuation">(</span><span class="token punctuation">{</span> baseURL<span class="token punctuation">,</span> axios <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>允许设置全局属性，每个<code>VuexSugar</code>实例都会拥有这些属性。这里设置的属性会根据其属性类型，与<code>action选项</code>或者<code>action提交参数</code>进行合并，或被覆盖。</p></li></ul></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/Liaoct/vuex-sugar/edit/master/docs/api/README.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面！</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <!----> </div> <!----></div></div>
    <script src="/vuex-sugar/assets/js/app.91decff7.js" defer></script><script src="/vuex-sugar/assets/js/5.77932b6a.js" defer></script>
  </body>
</html>
